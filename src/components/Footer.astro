---
import ThemeSwitch from "./ThemeSwitch.astro";
---

<ThemeSwitch />

<script
  type="text/javascript"
  src="https://gw.alipayobjects.com/os/k/h3/heti-addon.min.js"></script>
<script
  type="text/javascript"
  src="https://gw.alipayobjects.com/os/k/3j/lozad.min.js"></script>
<script
  type="text/javascript"
  src="https://gw.alipayobjects.com/os/k/s3/lightense.min.js"></script>

<!-- This is intentionally inlined to avoid FOUC -->
<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    // Optimization of letter spacing
    const heti = new Heti(".heti");
    heti.autoSpacing();

    // Lazy loading of images
    const observer = lozad(".lozad", {
      loaded: (el) => {
        el.alt = el.getAttribute("data-alt");
      },
    });
    observer.observe();

    // Open external links in a new tab
    Array.from(document.links).forEach((link) => {
      if (link.hostname !== window.location.hostname) {
        link.target = "_blank";
        // 跟踪外部链接点击
        link.addEventListener('click', () => {
          if (typeof gtag !== 'undefined') {
            gtag('event', 'click_external_link', {
              'link_url': link.href,
              'link_text': link.textContent
            });
          }
        });
      }
    });

    // Image zoom
    const zoomImgs = document.querySelectorAll("#write img");
    if (zoomImgs.length > 0) {
      Lightense && Lightense(zoomImgs,{
         background: 'rgba(255, 255, 255, .8)',
      });
    }
  });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=G-Q3HX0EYJV5"
  is:inline></script>
<script>
  // @ts-nocheck
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());
  gtag("config", "G-Q3HX0EYJV5");
</script>
